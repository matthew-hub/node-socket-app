<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>peerjs</title>
</head>
<body>
  <p>receiver</p>
  <h1 id="id"></h1>
  <video id="remoteVideo" autoplay playsinline width="240" height="240"></video>
  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>

  <script type="text/javascript">

    const peer = new Peer();
    const connectid = document.getElementById('id');
    console.log('[id]:',id);
    
    console.log('[peer]:',peer);

    peer.on('open', (id) => {
      console.log('[My peer id is]:', id);
      connectid.innerHTML = id;
    })
    peer.on('connection', (conn) => { 
      console.log('[connection]:',conn);
      conn.on('data', (data) => {
        console.log('[data]:',data);
        
      })
    });
    const remoteVideo = document.getElementById('remoteVideo');
    const getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;
    peer.on('call', (call) => {
      console.log('[call]:',call);
      call.answer();
      call.on('stream', (remoteStream)=> {
        console.log('[remoteStream]:',remoteStream);
          
        remoteVideo.srcObject = remoteStream
      })
      // getUserMedia({video: true, audio: false}, (stream) => {
      //   // call.answer(stream);
      //   // call.on('stream', (remoteStream)=> {
      //   //   console.log('[remoteStream]:',remoteStream);
          
      //   //   remoteVideo.srcObject = remoteStream
      //   // })
      // }, (err) => {
      //   console.log('[Failed to get localstrean]:',err);
        
      // })
    })
    // const conn = peer.connect('another-peers-id');
    // // on open will be launch when you successfully connect to PeerServer
    // conn.on('open', function(){
    //   // here you have conn.id
    //   conn.send('hi!');
    // });
    
  </script>
</body>
</html>